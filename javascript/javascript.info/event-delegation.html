<!DOCTYPE html><html lang="en">
<!-- Mirrored from javascript.info/event-delegation by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Sep 2018 10:50:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><script>window.currentUser = null;</script><title itemprop="name">Event delegation</title><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700%7COpen+Sans+Condensed:700&amp;subset=latin,latin-ext,cyrillic,cyrillic-ext" rel="stylesheet"><link rel="apple-touch-icon-precomposed" href="img/favicon/apple-touch-icon-precomposed.png"><link rel="canonical" href="event-delegation.html"><meta name="msapplication-TileColor" content="#222A2C"><meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"><!-- favicon the rest--><link rel="icon" href="img/favicon/favicon.png"><meta itemprop="image" content="https://javascript.info/img/site_preview_en_512x512.png"><meta property="og:title" content="Event delegation"><meta property="og:image" content="https://javascript.info/img/site_preview_en_1200x630.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="fb:admins" content="100001562528165"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Event delegation"><meta name="twitter:site" content="@iliakan"><meta name="twitter:creator" content="@iliakan"><meta name="twitter:image" content="https://javascript.info/img/site_preview_en_512x512.png"><link href="pack/styles.b363cbd7204b6ec74a4cbeca7061b31d.css" rel="stylesheet"><link rel="prev" href="bubbling-and-capturing.html"><link rel="next" href="default-browser-action.html"><script>window.GA_ID = "UA-2056213-15";</script><script>window.YANDEX_METRIKA_ID = 32184394;</script><script>window.GoogleAnalyticsObject="ga",window.ga=function(){window.ga.q.push(arguments)},window.ga.q=[],window.ga.l=Date.now(),ga("create",GA_ID,"auto"),window.currentUser?ga("set","&uid",currentUser.id):ga("set","anonymizeIp",!0),window.addEventListener("error",function(e){var n=(e.filename||e.errorUrl)+": "+(e.lineno||e.errorLine),r=e.stack||e.error&&e.error.stack;ga("send","exception",{exDescription:e.message+" "+n+" "+r,exFatal:!0})});</script><script src="../www.google-analytics.com/analytics.js" async></script><script>ga('send', 'pageview');</script><script>window.metrika={reachGoal:function(){}},window.yandex_metrika_callbacks=[function(){try{window.metrika=new Ya.Metrika({id:YANDEX_METRIKA_ID,webvisor:!0,clickmap:!0,params:{user:window.currentUser&&window.currentUser.id}}),metrika.trackLinks({delay:150}),window.addEventListener("error",function(r){window.metrika.reachGoal("JSERROR",{src:(r.filename||r.errorUrl)+": "+(r.lineno||r.errorLine),stack:r.stack||r.error&&r.error.stack,message:r.message})})}catch(r){}}];</script><script src="../mc.yandex.ru/metrika/watch.js" async></script><script>window.RECAPTCHA_ID = "6Lf9NyETAAAAACZlg-a9Us2SxvYbeVC1ROWaWv4O";</script><script src="inite4da.js?5"></script><script src="pack/head.5ac6aee21473ea597203.js" defer></script><meta property="og:title" content="Event delegation"><meta property="og:type" content="article"><script src="pack/tutorial.5ac6aee21473ea597203.js" defer></script><script src="pack/footer.5ac6aee21473ea597203.js" defer></script></head><body class="no-icons"><script>window.fontTest();</script><div class="page-wrapper page-wrapper_sidebar_on"><!--[if lt IE 10]><div style="color:red;text-align:center">Sorry, IE&lt;10 is not supported, please use a newer browser.</div><![endif]--><div class="sitetoolbar sitetoolbar_tutorial"><div style="display:none" id="notify-en-tutorial" class="notification notification_info notification_top sitetoolbar__notification"><div class="notification__content">The tutorial was recently rewritten from scratch. There may be typos, please use the "Edit on Github" link (in left sidebar in an article, at the bottom) to propose fixes.
Thank you!</div><button title="Close" class="notification__close"></button></div><script>showTopNotification();</script><div class="sitetoolbar__content"><div class="sitetoolbar__logo-wrap"><a href="index.html" class="sitetoolbar__link sitetoolbar__link_logo"><img src="img/sitetoolbar__logo_en.svg" width="200" class="sitetoolbar__logo sitetoolbar__logo_normal" alt=""><img src="img/sitetoolbar__logo_small_en.svg" width="70" class="sitetoolbar__logo sitetoolbar__logo_small" alt=""><script>Array.prototype.forEach.call(document.querySelectorAll("img.sitetoolbar__logo"),function(e){var t=document.createElement("object");t.type="image/svg+xml",t.className=e.className,t.style.cssText="left:0;top:0;position:absolute",t.onload=function(){t.onload=null,e.style.visibility="hidden"},t.data=e.src,e.parentNode.insertBefore(t,e)});</script></a></div><div class="sitetoolbar__nav-toggle-wrap"><button type="button" class="sitetoolbar__nav-toggle"></button></div><nav class="sitetoolbar__sections"><ul class="sitetoolbar__sections-list"><li class="sitetoolbar__section sitetoolbar__section_current"><a href="index.html" class="sitetoolbar__link">Tutorial</a></li><li class="sitetoolbar__section"><a href="courses.html" class="sitetoolbar__link">Courses</a></li></ul></nav><div class="sitetoolbar__book-wrap"><a href="ebook.html" class="buy-book-button"><span class="buy-book-button__extra-text">Buy</span>EPUB/PDF</a></div><div class="sitetoolbar__login-wrap"><button data-action-login class="sitetoolbar__login sitetoolbar__login_unready"></button></div><div class="sitetoolbar__search-wrap"><div class="sitetoolbar__search-content"><form method="GET" action="http://javascript.info/search" class="sitetoolbar__search"><button type="button" class="sitetoolbar__search-toggle"></button><div class="sitetoolbar__search-input"><div class="text-input"><input autofocus name="query" placeholder="Search on Javascript.info" class="text-input__control" type="text"></div><button type="submit" class="sitetoolbar__find">Search</button></div></form></div></div></div><!-- todo: en variant--><div class="tablet-menu"><div class="tablet-menu__line"><div class="tablet-menu__content"><select onchange="if(this.value) window.location.href=this.value" class="input-select input-select_small tablet-menu__nav"><option value="/tutorial" selected>Tutorial</option><option value="/courses">Courses</option></select></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><form action="http://javascript.info/search/" class="tablet-menu-search"><input type="search" name="query" placeholder="Search in the tutorial" required class="tablet-menu-search__input"><button type="submit" name="type" value="articles" class="tablet-menu-search__button">Search</button></form></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><a href="tutorial/map.html" data-action="tutorial-map" class="map"><span class="map__text">Tutorial map</span></a></div></div><!--+e.line--><!--  +e.content--><!--    +b("a").tablet-ebook(href="/ebook")--><!--      +e("span").text Купить учебник--><!--      +e("span").note (EPUB + PDF)--><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="share-icons"><span class="share-icons__title">Share</span><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_tw"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_fb"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_gp"></a><a href="https://vkontakte.ru/share.php?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_vk"></a></div></div></div></div><progress data-sticky value="14" max="27" data-tooltip="Lesson 14 of 27" class="tutorial-progress"></progress></div><div class="page page_sidebar_on"><script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");var pageWrapper=document.querySelector(".page-wrapper");pageWrapper&&pageWrapper.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")},0);</script><div class="page__inner"><main class="main main_width-limit"><header class="main__header"><div class="main__header-inner"><ol class="breadcrumbs"><li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb-1" class="breadcrumbs__item breadcrumbs__item_home"><a href="index.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title" class="breadcrumbs__hidden-text">Tutorial</span></a></li><li id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb-2" itemprop="child" class="breadcrumbs__item"><a href="ui.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title">Browser: Document, Events, Interfaces</span></a></li><li id="breadcrumb-2" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="breadcrumbs__item"><a href="events.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title">Introduction into Events</span></a></li></ol><h1 class="main__header-title">Event delegation</h1></div></header><div class="content"><article itemscope itemtype="http://schema.org/TechArticle"><meta itemprop="name" content="Event delegation"><div itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="email" content="iliakan@gmail.com"><meta itemprop="name" content="Ilya Kantor"></div><div itemprop="articleBody"><p>Capturing and bubbling allow us to implement one of most powerful event handling patterns called <em>event delegation</em>.</p>
<p>The idea is that if we have a lot of elements handled in a similar way, then instead of assigning a handler to each of them – we put a single handler on their common ancestor.</p>
<p>In the handler we get <code>event.target</code>, see where the event actually happened and handle it.</p>
<p>Let’s see an example – the <a href="http://en.wikipedia.org/wiki/Ba_gua">Ba-Gua diagram</a> reflecting the ancient Chinese philosophy.</p>
<p>Here it is:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"><div class="toolbar__tool">
        <a href="https://en.js.cx/article/event-delegation/bagua/" target="_blank" title="open in new window" class="toolbar__button toolbar__button_external"></a>
      </div>
      <div class="toolbar__tool">
        <a href="http://plnkr.co/edit/Q4Re3p6csWjsIFCniBVh?p=preview" target="_blank" title="open in sandbox"
        data-plunk-id="Q4Re3p6csWjsIFCniBVh" class="toolbar__button toolbar__button_edit"></a>
      </div>
      </div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:350px" src="https://en.js.cx/article/event-delegation/bagua/"></iframe>
  </div><p>The HTML is like this:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;table&gt;
  &lt;tr&gt;
    &lt;th colspan=&quot;3&quot;&gt;&lt;em&gt;Bagua&lt;/em&gt; Chart: Direction, Element, Color, Meaning&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;...&lt;strong&gt;Northwest&lt;/strong&gt;...&lt;/td&gt;
    &lt;td&gt;...&lt;/td&gt;
    &lt;td&gt;...&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;...2 more lines of this kind...&lt;/tr&gt;
  &lt;tr&gt;...2 more lines of this kind...&lt;/tr&gt;
&lt;/table&gt;</code></pre>
        </div>
      </div>
      
      </div><p>The table has 9 cells, but there could be 99 or 9999, doesn’t matter.</p>
<p><strong>Our task is to highlight a cell <code>&lt;td&gt;</code> on click.</strong></p>
<p>Instead of assign an <code>onclick</code> handler to each <code>&lt;td&gt;</code> (can be many) – we’ll setup the “catch-all” handler on <code>&lt;table&gt;</code> element.</p>
<p>It will use <code>event.target</code> to get the clicked element and highlight it.</p>
<p>The code:</p>
<div data-trusted="1" class="code-example" data-highlight-block="2-8">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">let selectedTd;

table.onclick = function(event) {
  let target = event.target; // where was the click?

  if (target.tagName != 'TD') return; // not on TD? Then we're not interested

  highlight(target); // highlight it
};

function highlight(td) {
  if (selectedTd) { // remove the existing highlight if any
    selectedTd.classList.remove('highlight');
  }
  selectedTd = td;
  selectedTd.classList.add('highlight'); // highlight the new td
}</code></pre>
        </div>
      </div>
      
      </div><p>Such a code doesn’t care how many cells there are in the table. We can add/remove <code>&lt;td&gt;</code> dynamically at any time and the highlighting will still work.</p>
<p>Still, there’s a drawback.</p>
<p>The click may occur not on the <code>&lt;td&gt;</code>, but inside it.</p>
<p>In our case if we take a look inside the HTML, we can see nested tags inside <code>&lt;td&gt;</code>, like <code>&lt;strong&gt;</code>:</p>
<div data-trusted="1" class="code-example" data-highlight-block="1-1">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;td&gt;
  &lt;strong&gt;Northwest&lt;/strong&gt;
  ...
&lt;/td&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Naturally, if a click happens on that <code>&lt;strong&gt;</code> then it becomes the value of <code>event.target</code>.</p>
<figure><div class="image" style="width:345px">
      <div class="image__ratio" style="padding-top:48.11594202898551%"></div>
      <img src="article/event-delegation/bagua-bubble.png" alt="" width="345" height="166" class="image__image">
      </div></figure><p>In the handler <code>table.onclick</code> we should take such <code>event.target</code> and find out whether the click was inside <code>&lt;td&gt;</code> or not.</p>
<p>Here’s the improved code:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">table.onclick = function(event) {
  let td = event.target.closest('td'); // (1)

  if (!td) return; // (2)

  if (!table.contains(td)) return; // (3)

  highlight(td); // (4)
};</code></pre>
        </div>
      </div>
      
      </div><p>Explanations:</p>
<ol>
<li>The method <code>elem.closest(selector)</code> returns the nearest ancestor that matches the selector. In our case we look for <code>&lt;td&gt;</code> on the way up from the source element.</li>
<li>If <code>event.target</code> is not inside any <code>&lt;td&gt;</code>, then the call returns <code>null</code>, and we don’t have to do anything.</li>
<li>In case of nested tables, <code>event.target</code> may be a <code>&lt;td&gt;</code> lying outside of the current table. So we check if that’s actually <em>our table’s</em> <code>&lt;td&gt;</code>.</li>
<li>And, if it’s so, then highlight it.</li>
</ol>
<h2><a class="main__anchor" name="delegation-example-actions-in-markup" href="#delegation-example-actions-in-markup">Delegation example: actions in markup</a></h2><p>The event delegation may be used to optimize event handling. We use a single handler for similar actions on many elements. Like we did it for highlighting <code>&lt;td&gt;</code>.</p>
<p>But we can also use a single handler as an entry point for many different things.</p>
<p>For instance, we want to make a menu with buttons “Save”, “Load”, “Search” and so on. And there’s an object with methods <code>save</code>, <code>load</code>, <code>search</code>….</p>
<p>The first idea may be to assign a separate handler to each button. But there’s a more elegant solution. We can add a handler for the whole menu and <code>data-action</code> attributes for buttons that has the method to call:</p>
<div data-trusted="1" class="code-example" data-highlight-inline="0:8-26">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;button data-action=&quot;save&quot;&gt;Click to Save&lt;/button&gt;</code></pre>
        </div>
      </div>
      
      </div><p>The handler reads the attribute and executes the method. Take a look at the working example:</p>
<div data-trusted="1" class="code-example" data-demo-height="60" data-autorun="true" data-highlight-block="26-29">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;div id=&quot;menu&quot;&gt;
  &lt;button data-action=&quot;save&quot;&gt;Save&lt;/button&gt;
  &lt;button data-action=&quot;load&quot;&gt;Load&lt;/button&gt;
  &lt;button data-action=&quot;search&quot;&gt;Search&lt;/button&gt;
&lt;/div&gt;

&lt;script&gt;
  class Menu {
    constructor(elem) {
      this._elem = elem;
      elem.onclick = this.onClick.bind(this); // (*)
    }

    save() {
      alert('saving');
    }

    load() {
      alert('loading');
    }

    search() {
      alert('searching');
    }

    onClick(event) {
      let action = event.target.dataset.action;
      if (action) {
        this[action]();
      }
    };
  }

  new Menu(menu);
&lt;/script&gt;</code></pre>
        </div>
      </div>
      <div class="code-result code-example__result">
        <iframe
          class="code-result__iframe"
          name="code-result-2rzri"
          style="height:60px"
          src="about:blank"></iframe>
      </div>
      </div><p>Please note that <code>this.onClick</code> is bound to <code>this</code> in <code>(*)</code>. That’s important, because otherwise <code>this</code> inside it would reference the DOM element (<code>elem</code>), not the menu object, and <code>this[action]</code> would not be what we need.</p>
<p>So, what the delegation gives us here?</p>
<div class="balance balance_single"><div class="balance__pluses"><div class="balance__content"><ul class="balance__list"><li>We don’t need to write the code to assign a handler to each button. Just make a method and put it in the markup.</li>
<li>The HTML structure is flexible, we can add/remove buttons at any time.</li>
</ul></div></div></div><p>We could also use classes <code>.action-save</code>, <code>.action-load</code>, but an attribute <code>data-action</code> is better semantically. And we can use it in CSS rules too.</p>
<h2><a class="main__anchor" name="the-behavior-pattern" href="#the-behavior-pattern">The “behavior” pattern</a></h2><p>We can also use event delegation to add “behaviors” to elements <em>declaratively</em>, with special attributes and classes.</p>
<p>The pattern has two parts:</p>
<ol>
<li>We add a special attribute to an element.</li>
<li>A document-wide handler tracks events, and if an event happens on an attributed element – performs the action.</li>
</ol>
<h3><a class="main__anchor" name="counter" href="#counter">Counter</a></h3><p>For instance, here the attribute <code>data-counter</code> adds a behavior: “increase on click” to buttons:</p>
<div data-trusted="1" class="code-example" data-demo-height="60" data-autorun="true">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">Counter: &lt;input type=&quot;button&quot; value=&quot;1&quot; data-counter&gt;
One more counter: &lt;input type=&quot;button&quot; value=&quot;2&quot; data-counter&gt;

&lt;script&gt;
  document.addEventListener('click', function(event) {

    if (event.target.dataset.counter != undefined) { // if the attribute exists...
      event.target.value++;
    }

  });
&lt;/script&gt;</code></pre>
        </div>
      </div>
      <div class="code-result code-example__result">
        <iframe
          class="code-result__iframe"
          name="code-result-e55dey"
          style="height:60px"
          src="about:blank"></iframe>
      </div>
      </div><p>If we click a button – its value is increased. Not buttons, but the general approach is important here.</p>
<p>There can be as many attributes with <code>data-counter</code> as we want. We can add new ones to HTML at any moment. Using the event delegation we “extended” HTML, added an attribute that describes a new behavior.</p>
<div class="important important_warn">
            <div class="important__header"><span class="important__type">For document-level handlers – always <code>addEventListener</code></span></div>
            <div class="important__content"><p>When we assign an event handler to the <code>document</code> object, we should always use <code>addEventListener</code>, not <code>document.onclick</code>, because the latter will cause conflicts: new handlers overwrite old ones.</p>
<p>For real projects it’s normal that there are many handlers on <code>document</code> set by different parts of the code.</p>
</div></div>
<h3><a class="main__anchor" name="toggler" href="#toggler">Toggler</a></h3><p>One more example. A click on an element with the attribute <code>data-toggle-id</code> will show/hide the element with the given <code>id</code>:</p>
<div data-trusted="1" class="code-example" data-demo-height="60" data-autorun="true" data-highlight-block="9-16" data-highlight-inline="0:8-39">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;button data-toggle-id=&quot;subscribe-mail&quot;&gt;
  Show the subscription form
&lt;/button&gt;

&lt;form id=&quot;subscribe-mail&quot; hidden&gt;
  Your mail: &lt;input type=&quot;email&quot;&gt;
&lt;/form&gt;

&lt;script&gt;
  document.addEventListener('click', function(event) {
    let id = event.target.dataset.toggleId;
    if (!id) return;

    let elem = document.getElementById(id);

    elem.hidden = !elem.hidden;
  });
&lt;/script&gt;</code></pre>
        </div>
      </div>
      <div class="code-result code-example__result">
        <iframe
          class="code-result__iframe"
          name="code-result-b78wu9"
          style="height:60px"
          src="about:blank"></iframe>
      </div>
      </div><p>Let’s note once again what we did. Now, to add toggling functionality to an element – there’s no need to know JavaScript, just use the attribute <code>data-toggle-id</code>.</p>
<p>That may become really convenient – no need to write JavaScript for every such element. Just use the behavior. The document-level handler makes it work for any element of the page.</p>
<p>We can combine multiple behaviors on a single element as well.</p>
<p>The “behavior” pattern can be an alternative of mini-fragments of JavaScript.</p>
<h2><a class="main__anchor" name="summary" href="#summary">Summary</a></h2><p>Event delegation is really cool! It’s one of the most helpful patterns for DOM events.</p>
<p>It’s often used to add same handling for many similar elements, but not only for that.</p>
<p>The algorithm:</p>
<ol>
<li>Put a single handler on the container.</li>
<li>In the handler – check the source element <code>event.target</code>.</li>
<li>If the event happened inside an element that interests us, then handle the event.</li>
</ol>
<p>Benefits:</p>
<div class="balance balance_single"><div class="balance__pluses"><div class="balance__content"><ul class="balance__list"><li>Simplifies initialization and saves memory: no need to add many handlers.</li>
<li>Less code: when adding or removing elements, no need to add/remove handlers.</li>
<li>DOM modifications: we can mass add/remove elements with <code>innerHTML</code> and alike.</li>
</ul></div></div></div><p>The delegation has its limitations of course:</p>
<div class="balance balance_single"><div class="balance__minuses"><div class="balance__content"><ul class="balance__list"><li>First, the event must be bubbling. Some events do not bubble. Also, low-level handlers should not use <code>event.stopPropagation()</code>.</li>
<li>Second, the delegation may add CPU load, because the container-level handler reacts on events in any place of the container, no matter if they interest us or not. But usually the load is negligible, so we don’t take it into account.</li>
</ul></div></div></div></div></article><div class="tasks"><h2 id="tasks" class="tasks__title"><a href="#tasks" class="main__anchor main__anchor_noicon tasks__title-anchor">Tasks</a></h2><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a href="#hide-messages-with-delegation" name="hide-messages-with-delegation" class="main__anchor">Hide messages with delegation</a></h3><a href="task/hide-message-delegate.html" target="_blank" class="task__open-link"></a></div><div class="task__header-note"><span title="How important is the task, from 1 to 5" class="task__importance">importance: 5</span></div><div class="task__content"><p>There’s a list of messages with removal buttons <code>[x]</code>. Make the buttons work.</p>
<p>Like this:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"></div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:420px" src="https://en.js.cx/task/hide-message-delegate/solution/"></iframe>
  </div><p>P.S. Should be only one event listener on the container, use event delegation.</p>
<p><a href="http://plnkr.co/edit/v2RTNbjguX05qMsO3SGO?p=preview" target="_blank" data-plunk-id="v2RTNbjguX05qMsO3SGO">Open the sandbox for the task.</a></p><button type="button" class="task__solution">solution</button><div class="task__answer"><div class="task__answer-content"><p><a href="http://plnkr.co/edit/MhLwEUmHoXqhzSbKhslZ?p=preview" target="_blank" data-plunk-id="MhLwEUmHoXqhzSbKhslZ">Open the solution in the sandbox.</a></p></div><button type="button" title="close" class="close-button task__answer-close"></button></div></div></div></div><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a href="#tree-menu" name="tree-menu" class="main__anchor">Tree menu</a></h3><a href="task/sliding-tree.html" target="_blank" class="task__open-link"></a></div><div class="task__header-note"><span title="How important is the task, from 1 to 5" class="task__importance">importance: 5</span></div><div class="task__content"><p>Create a tree that shows/hides node children on click:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"></div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:300px" src="https://en.js.cx/task/sliding-tree/solution/"></iframe>
  </div><p>Requirements:</p>
<ul>
<li>Only one event handler (use delegation)</li>
<li>A click outside the node title (on an empty space) should not do anything.</li>
</ul>
<p><a href="http://plnkr.co/edit/T63g6VROJHyr3cfNIgZg?p=preview" target="_blank" data-plunk-id="T63g6VROJHyr3cfNIgZg">Open the sandbox for the task.</a></p><button type="button" class="task__solution">solution</button><div class="task__answer"><div class="task__answer-content"><p>The solution has two parts.</p>
<ol>
<li>Wrap every tree node title into <code>&lt;span&gt;</code>. Then we can CSS-style them on <code>:hover</code> and handle clicks exactly on text, because <code>&lt;span&gt;</code> width is exactly the text width (unlike without it).</li>
<li>Set a handler to the <code>tree</code> root node and handle clicks on that <code>&lt;span&gt;</code> titles.</li>
</ol>
<p><a href="http://plnkr.co/edit/cYxGwZnQ509RShaszKz1?p=preview" target="_blank" data-plunk-id="cYxGwZnQ509RShaszKz1">Open the solution in the sandbox.</a></p></div><button type="button" title="close" class="close-button task__answer-close"></button></div></div></div></div><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a href="#sortable-table" name="sortable-table" class="main__anchor">Sortable table</a></h3><a href="task/sortable-table.html" target="_blank" class="task__open-link"></a></div><div class="task__header-note"><span title="How important is the task, from 1 to 5" class="task__importance">importance: 4</span></div><div class="task__content"><p>Make the table sortable: clicks on <code>&lt;th&gt;</code> elements should sort it by corresponding column.</p>
<p>Each <code>&lt;th&gt;</code> has the type in the attribute, like this:</p>
<div data-trusted="1" class="code-example" data-highlight-block="3-4">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;table id=&quot;grid&quot;&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th data-type=&quot;number&quot;&gt;Age&lt;/th&gt;
      &lt;th data-type=&quot;string&quot;&gt;Name&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;John&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;Ann&lt;/td&gt;
    &lt;/tr&gt;
    ...
  &lt;/tbody&gt;
&lt;/table&gt;</code></pre>
        </div>
      </div>
      
      </div><p>In the example above the first column has numbers, and the second one – strings. The sorting function should handle sort according to the type.</p>
<p>Only <code>&quot;string&quot;</code> and <code>&quot;number&quot;</code> types should be supported.</p>
<p>The working example:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"></div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:190px" src="https://en.js.cx/task/sortable-table/solution/"></iframe>
  </div><p>P.S. The table can be big, with any number of rows and columns.</p>
<p><a href="http://plnkr.co/edit/KvjWC7nd5zeRKwvKCKHs?p=preview" target="_blank" data-plunk-id="KvjWC7nd5zeRKwvKCKHs">Open the sandbox for the task.</a></p><button type="button" class="task__solution">solution</button><div class="task__answer"><div class="task__answer-content"><p><a href="http://plnkr.co/edit/Tq9UXO65JRokK8NXbi2H?p=preview" target="_blank" data-plunk-id="Tq9UXO65JRokK8NXbi2H">Open the solution in the sandbox.</a></p></div><button type="button" title="close" class="close-button task__answer-close"></button></div></div></div></div><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a href="#tooltip-behavior" name="tooltip-behavior" class="main__anchor">Tooltip behavior</a></h3><a href="task/behavior-tooltip.html" target="_blank" class="task__open-link"></a></div><div class="task__header-note"><span title="How important is the task, from 1 to 5" class="task__importance">importance: 5</span></div><div class="task__content"><p>Create JS-code for the tooltip behavior.</p>
<p>When a mouse comes over an element with <code>data-tooltip</code>, the tooltip should appear over it, and when it’s gone then hide.</p>
<p>An example of annotated HTML:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;button data-tooltip=&quot;the tooltip is longer than the element&quot;&gt;Short button&lt;/button&gt;
&lt;button data-tooltip=&quot;HTML&lt;br&gt;tooltip&quot;&gt;One more button&lt;/button&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Should work like this:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"></div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:200px" src="https://en.js.cx/task/behavior-tooltip/solution/"></iframe>
  </div><p>In this task we assume that all elements with <code>data-tooltip</code> have only text inside. No nested tags.</p>
<p>Details:</p>
<ul>
<li>The tooltip should not cross window edges. Normally it should be above the element, but if the element is at the page top and there’s no space for the tooltip, then below it.</li>
<li>The tooltip is given in the <code>data-tooltip</code> attribute. It can be arbitrary HTML.</li>
</ul>
<p>You’ll need two events here:</p>
<ul>
<li><code>mouseover</code> triggers when a pointer comes over an element.</li>
<li><code>mouseout</code> triggers when a pointer leaves an element.</li>
</ul>
<p>Please use event delegation: set up two handlers on <code>document</code> to track all “overs” and “outs” from elements with <code>data-tooltip</code> and manage tooltips from there.</p>
<p>After the behavior is implemented, even people unfamiliar with JavaScript can add annotated elements.</p>
<p>P.S. To keep things natural and simple: only one tooltip may show up at a time.</p>
<p><a href="http://plnkr.co/edit/XPkjTxJjpo1vYNs5rVQm?p=preview" target="_blank" data-plunk-id="XPkjTxJjpo1vYNs5rVQm">Open the sandbox for the task.</a></p><button type="button" class="task__solution">solution</button><div class="task__answer"><div class="task__answer-content"><p><a href="http://plnkr.co/edit/vOnJAlynaYzwsfrGsISq?p=preview" target="_blank" data-plunk-id="vOnJAlynaYzwsfrGsISq">Open the solution in the sandbox.</a></p></div><button type="button" title="close" class="close-button task__answer-close"></button></div></div></div></div></div><!--if lang == 'en'--><!--  include /blocks/banner-bottom.en--></div><div class="page__nav-wrap"><a href="bubbling-and-capturing.html" data-tooltip="Bubbling and capturing" class="page__nav page__nav_prev"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Previous lesson</span></a><a href="default-browser-action.html" data-tooltip="Browser default actions" class="page__nav page__nav_next"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Next lesson</span></a></div><div class="article-tablet-foot tablet-only"><div class="article-tablet-foot__layout"><div class="share-icons"><span class="share-icons__title">Share</span><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_tw"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_fb"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_gp"></a><a href="https://vkontakte.ru/share.php?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_vk"></a></div><div class="article-tablet-foot__map"><a href="tutorial/map.html" data-action="tutorial-map" class="map"><span class="map__text">Tutorial map</span></a></div></div></div><div id="comments" class="comments"><div class="comments__header"><h2 class="comments__header-title"><a href="#comments" name="comments">Comments</a></h2><div class="comments__read-before"><span class="comments__read-before-link">read this before commenting…</span><div class="comments__read-before-popup"><div class="comments__read-before-popup-i"><ul><li>You're welcome to post additions, questions to the articles and answers to them.</li><li>To insert a few words of code, use the <code>&lt;code&gt;</code> tag, for several lines – use <code>&lt;pre&gt;</code>, for more than 10 lines – use a sandbox (<a href='http://plnkr.co/edit/?p=preview'>plnkr</a>, <a href='http://jsbin.com/'>JSBin</a>, <a href='http://codepen.io/'>codepen</a>…)</li><li>If you can't understand something in the article – please elaborate.</li></ul></div></div></div></div></div><div id="disqus_thread"></div><script>var disqus_config = function() { if (!this.page) this.page = {}; Object.assign(this.page, {"url":"https:\/\/javascript.info\/event-delegation","identifier":"\/event-delegation","title":"Event delegation"}); };</script><script>var disqus_shortname = "javascriptinfo";</script><script>var disqus_enabled = true;</script></main></div><div class="page__sidebar sidebar sidebar_sticky-footer"><button data-sidebar-toggle class="sidebar__toggle"></button><a href="tutorial/map.html" data-action="tutorial-map" data-tooltip="Tutorial map" class="map"></a><div class="sidebar__inner"><div class="sidebar__content"><div class="sidebar__section"><h4 class="sidebar__section-title">Chapter</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="events.html" class="sidebar__link">Introduction into Events</a></li></ul></nav></div><div class="sidebar__section"><h4 class="sidebar__section-title">Lesson navigation</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="#delegation-example-actions-in-markup" class="sidebar__link">Delegation example: actions in markup</a></li><li class="sidebar__navigation-link"><a href="#the-behavior-pattern" class="sidebar__link">The “behavior” pattern</a></li><li class="sidebar__navigation-link"><a href="#summary" class="sidebar__link">Summary</a></li></ul></nav></div><div class="sidebar__section"><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="#tasks" class="sidebar__link">Tasks (4)</a></li><li class="sidebar__navigation-link"><a href="#comments" class="sidebar__link">Comments</a></li></ul></nav></div><div class="sidebar__section"><div class="sidebar__section-title">Share</div><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_tw sidebar__share"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_fb sidebar__share"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fevent-delegation" class="share share_gp sidebar__share"></a></div><div class="sidebar__section"><a href="https://github.com/iliakan/javascript-tutorial-en/tree/master/2-ui/2-events/03-event-delegation/article.md" class="sidebar__link">Edit on Github</a></div></div></div></div></div></div><div class="page-footer"><div class="page-footer__left"><ul class="page-footer__list"><li class="page-footer__item">©&nbsp;2007—2018&nbsp; Ilya Kantor</li><li class="page-footer__item"><a href="about.html#contact-us" class="page-footer__link">contact us</a></li><li class="page-footer__item"><a href="about.html" class="page-footer__link">about the project</a></li><li class="page-footer__item"><a href="https://learn.javascript.ru/" class="page-footer__link">RU</a> / EN</li></ul></div><div class="page-footer__right"><ul class="page-footer__list"><li class="page-footer__item">powered by <a rel="nofollow" href="http://nodejs.org/" class="page-footer__link">node.js</a>&nbsp;&amp;&nbsp;<a rel="nofollow" href="http://github.com/iliakan/javascript-tutorial-en" class="page-footer__link">open source</a></li></ul></div></div></body>
<!-- Mirrored from javascript.info/event-delegation by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Sep 2018 10:50:51 GMT -->
</html>