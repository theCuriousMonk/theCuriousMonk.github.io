<!DOCTYPE html><html lang="en">
<!-- Mirrored from javascript.info/dispatch-events by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Sep 2018 10:50:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><script>window.currentUser = null;</script><title itemprop="name">Dispatching custom events</title><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700%7COpen+Sans+Condensed:700&amp;subset=latin,latin-ext,cyrillic,cyrillic-ext" rel="stylesheet"><link rel="apple-touch-icon-precomposed" href="img/favicon/apple-touch-icon-precomposed.png"><link rel="canonical" href="dispatch-events.html"><meta name="msapplication-TileColor" content="#222A2C"><meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"><!-- favicon the rest--><link rel="icon" href="img/favicon/favicon.png"><meta itemprop="image" content="https://javascript.info/img/site_preview_en_512x512.png"><meta property="og:title" content="Dispatching custom events"><meta property="og:image" content="https://javascript.info/img/site_preview_en_1200x630.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="fb:admins" content="100001562528165"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Dispatching custom events"><meta name="twitter:site" content="@iliakan"><meta name="twitter:creator" content="@iliakan"><meta name="twitter:image" content="https://javascript.info/img/site_preview_en_512x512.png"><link href="pack/styles.b363cbd7204b6ec74a4cbeca7061b31d.css" rel="stylesheet"><link rel="prev" href="default-browser-action.html"><link rel="next" href="event-details.html"><script>window.GA_ID = "UA-2056213-15";</script><script>window.YANDEX_METRIKA_ID = 32184394;</script><script>window.GoogleAnalyticsObject="ga",window.ga=function(){window.ga.q.push(arguments)},window.ga.q=[],window.ga.l=Date.now(),ga("create",GA_ID,"auto"),window.currentUser?ga("set","&uid",currentUser.id):ga("set","anonymizeIp",!0),window.addEventListener("error",function(e){var n=(e.filename||e.errorUrl)+": "+(e.lineno||e.errorLine),r=e.stack||e.error&&e.error.stack;ga("send","exception",{exDescription:e.message+" "+n+" "+r,exFatal:!0})});</script><script src="../www.google-analytics.com/analytics.js" async></script><script>ga('send', 'pageview');</script><script>window.metrika={reachGoal:function(){}},window.yandex_metrika_callbacks=[function(){try{window.metrika=new Ya.Metrika({id:YANDEX_METRIKA_ID,webvisor:!0,clickmap:!0,params:{user:window.currentUser&&window.currentUser.id}}),metrika.trackLinks({delay:150}),window.addEventListener("error",function(r){window.metrika.reachGoal("JSERROR",{src:(r.filename||r.errorUrl)+": "+(r.lineno||r.errorLine),stack:r.stack||r.error&&r.error.stack,message:r.message})})}catch(r){}}];</script><script src="../mc.yandex.ru/metrika/watch.js" async></script><script>window.RECAPTCHA_ID = "6Lf9NyETAAAAACZlg-a9Us2SxvYbeVC1ROWaWv4O";</script><script src="inite4da.js?5"></script><script src="pack/head.5ac6aee21473ea597203.js" defer></script><meta property="og:title" content="Dispatching custom events"><meta property="og:type" content="article"><script src="pack/tutorial.5ac6aee21473ea597203.js" defer></script><script src="pack/footer.5ac6aee21473ea597203.js" defer></script></head><body class="no-icons"><script>window.fontTest();</script><div class="page-wrapper page-wrapper_sidebar_on"><!--[if lt IE 10]><div style="color:red;text-align:center">Sorry, IE&lt;10 is not supported, please use a newer browser.</div><![endif]--><div class="sitetoolbar sitetoolbar_tutorial"><div style="display:none" id="notify-en-tutorial" class="notification notification_info notification_top sitetoolbar__notification"><div class="notification__content">The tutorial was recently rewritten from scratch. There may be typos, please use the "Edit on Github" link (in left sidebar in an article, at the bottom) to propose fixes.
Thank you!</div><button title="Close" class="notification__close"></button></div><script>showTopNotification();</script><div class="sitetoolbar__content"><div class="sitetoolbar__logo-wrap"><a href="index.html" class="sitetoolbar__link sitetoolbar__link_logo"><img src="img/sitetoolbar__logo_en.svg" width="200" class="sitetoolbar__logo sitetoolbar__logo_normal" alt=""><img src="img/sitetoolbar__logo_small_en.svg" width="70" class="sitetoolbar__logo sitetoolbar__logo_small" alt=""><script>Array.prototype.forEach.call(document.querySelectorAll("img.sitetoolbar__logo"),function(e){var t=document.createElement("object");t.type="image/svg+xml",t.className=e.className,t.style.cssText="left:0;top:0;position:absolute",t.onload=function(){t.onload=null,e.style.visibility="hidden"},t.data=e.src,e.parentNode.insertBefore(t,e)});</script></a></div><div class="sitetoolbar__nav-toggle-wrap"><button type="button" class="sitetoolbar__nav-toggle"></button></div><nav class="sitetoolbar__sections"><ul class="sitetoolbar__sections-list"><li class="sitetoolbar__section sitetoolbar__section_current"><a href="index.html" class="sitetoolbar__link">Tutorial</a></li><li class="sitetoolbar__section"><a href="courses.html" class="sitetoolbar__link">Courses</a></li></ul></nav><div class="sitetoolbar__book-wrap"><a href="ebook.html" class="buy-book-button"><span class="buy-book-button__extra-text">Buy</span>EPUB/PDF</a></div><div class="sitetoolbar__login-wrap"><button data-action-login class="sitetoolbar__login sitetoolbar__login_unready"></button></div><div class="sitetoolbar__search-wrap"><div class="sitetoolbar__search-content"><form method="GET" action="http://javascript.info/search" class="sitetoolbar__search"><button type="button" class="sitetoolbar__search-toggle"></button><div class="sitetoolbar__search-input"><div class="text-input"><input autofocus name="query" placeholder="Search on Javascript.info" class="text-input__control" type="text"></div><button type="submit" class="sitetoolbar__find">Search</button></div></form></div></div></div><!-- todo: en variant--><div class="tablet-menu"><div class="tablet-menu__line"><div class="tablet-menu__content"><select onchange="if(this.value) window.location.href=this.value" class="input-select input-select_small tablet-menu__nav"><option value="/tutorial" selected>Tutorial</option><option value="/courses">Courses</option></select></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><form action="http://javascript.info/search/" class="tablet-menu-search"><input type="search" name="query" placeholder="Search in the tutorial" required class="tablet-menu-search__input"><button type="submit" name="type" value="articles" class="tablet-menu-search__button">Search</button></form></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><a href="tutorial/map.html" data-action="tutorial-map" class="map"><span class="map__text">Tutorial map</span></a></div></div><!--+e.line--><!--  +e.content--><!--    +b("a").tablet-ebook(href="/ebook")--><!--      +e("span").text Купить учебник--><!--      +e("span").note (EPUB + PDF)--><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="share-icons"><span class="share-icons__title">Share</span><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_tw"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_fb"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_gp"></a><a href="https://vkontakte.ru/share.php?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_vk"></a></div></div></div></div><progress data-sticky value="16" max="27" data-tooltip="Lesson 16 of 27" class="tutorial-progress"></progress></div><div class="page page_sidebar_on"><script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");var pageWrapper=document.querySelector(".page-wrapper");pageWrapper&&pageWrapper.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")},0);</script><div class="page__inner"><main class="main main_width-limit"><header class="main__header"><div class="main__header-inner"><ol class="breadcrumbs"><li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb-1" class="breadcrumbs__item breadcrumbs__item_home"><a href="index.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title" class="breadcrumbs__hidden-text">Tutorial</span></a></li><li id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb-2" itemprop="child" class="breadcrumbs__item"><a href="ui.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title">Browser: Document, Events, Interfaces</span></a></li><li id="breadcrumb-2" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="breadcrumbs__item"><a href="events.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title">Introduction into Events</span></a></li></ol><h1 class="main__header-title">Dispatching custom events</h1></div></header><div class="content"><article itemscope itemtype="http://schema.org/TechArticle"><meta itemprop="name" content="Dispatching custom events"><div itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="email" content="iliakan@gmail.com"><meta itemprop="name" content="Ilya Kantor"></div><div itemprop="articleBody"><p>We can not only assign handlers, but also generate events from JavaScript.</p>
<p>Custom events can be used to create “graphical components”. For instance, a root element of the menu may trigger events telling what happens with the menu: <code>open</code> (menu open),  <code>select</code> (an item is selected) and so on.</p>
<p>Also we can generate built-in events like <code>click</code>, <code>mousedown</code> etc, that may be good for testing.</p>
<h2><a class="main__anchor" name="event-constructor" href="#event-constructor">Event constructor</a></h2><p>Events form a hierarchy, just like DOM element classes. The root is the built-in <a href="http://www.w3.org/TR/dom/#event">Event</a> class.</p>
<p>We can create <code>Event</code> objects like this:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">let event = new Event(event type[, options]);</code></pre>
        </div>
      </div>
      
      </div><p>Arguments:</p>
<ul>
<li>
<p><em>event type</em> – may be any string, like <code>&quot;click&quot;</code> or our own like <code>&quot;hey-ho!&quot;</code>.</p>
</li>
<li>
<p><em>options</em> – the object with two optional properties:</p>
<ul>
<li><code>bubbles: true/false</code> – if <code>true</code>, then the event bubbles.</li>
<li><code>cancelable: true/false</code> – if <code>true</code>, then the “default action”  may be prevented. Later we’ll see what it means for custom events.</li>
</ul>
<p>By default both are false: <code>{bubbles: false, cancelable: false}</code>.</p>
</li>
</ul>
<h2><a class="main__anchor" name="dispatchevent" href="#dispatchevent">dispatchEvent</a></h2><p>After an event object is created, we should “run” it on an element using the call  <code>elem.dispatchEvent(event)</code>.</p>
<p>Then handlers react on it as if it were a regular built-in event. If the event was created with the <code>bubbles</code> flag, then it bubbles.</p>
<p>In the example below the <code>click</code> event is initiated in JavaScript. The handler works same way as if the button was clicked:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;button id=&quot;elem&quot; onclick=&quot;alert('Click!');&quot;&gt;Autoclick&lt;/button&gt;

&lt;script&gt;
  let event = new Event(&quot;click&quot;);
  elem.dispatchEvent(event);
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><div class="important important_smart">
            <div class="important__header"><span class="important__type">event.isTrusted</span></div>
            <div class="important__content"><p>There is a way to tell a “real” user event from a script-generated one.</p>
<p>The property <code>event.isTrusted</code> is <code>true</code> for events that come from real user actions and <code>false</code> for script-generated events.</p>
</div></div>
<h2><a class="main__anchor" name="bubbling-example" href="#bubbling-example">Bubbling example</a></h2><p>We can create a bubbling event with the name <code>&quot;hello&quot;</code> and catch it on <code>document</code>.</p>
<p>All we need is to set <code>bubbles</code> to <code>true</code>:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;h1 id=&quot;elem&quot;&gt;Hello from the script!&lt;/h1&gt;

&lt;script&gt;
  // catch on document...
  document.addEventListener(&quot;hello&quot;, function(event) { // (1)
    alert(&quot;Hello from &quot; + event.target.tagName); // Hello from H1
  });

  // ...dispatch on elem!
  let event = new Event(&quot;hello&quot;, {bubbles: true}); // (2)
  elem.dispatchEvent(event);
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Notes:</p>
<ol>
<li>We should use <code>addEventListener</code> for our custom events, because <code>on&lt;event&gt;</code> only exists for built-in events, <code>document.onhello</code> doesn’t work.</li>
<li>Must set <code>bubbles:true</code>, otherwise the event won’t bubble up.</li>
</ol>
<p>The bubbling mechanics is the same for built-in (<code>click</code>) and custom (<code>hello</code>) events. There are also capturing and bubbling stages.</p>
<h2><a class="main__anchor" name="mouseevent-keyboardevent-and-others" href="#mouseevent-keyboardevent-and-others">MouseEvent, KeyboardEvent and others</a></h2><p>Here’s a short list of classes for UI Events from the <a href="https://www.w3.org/TR/uievents">UI Event specification</a>:</p>
<ul>
<li><code>UIEvent</code></li>
<li><code>FocusEvent</code></li>
<li><code>MouseEvent</code></li>
<li><code>WheelEvent</code></li>
<li><code>KeyboardEvent</code></li>
<li>…</li>
</ul>
<p>We should use them instead of <code>new Event</code> if we want to create such events. For instance, <code>new MouseEvent(&quot;click&quot;)</code>.</p>
<p>The right constructor allows to specify standard properties for that type of event.</p>
<p>Like <code>clientX/clientY</code> for a mouse event:</p>
<div data-trusted="1" class="code-example" data-highlight-block="7-7">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="run" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">let event = new MouseEvent(&quot;click&quot;, {
  bubbles: true,
  cancelable: true,
  clientX: 100,
  clientY: 100
});

alert(event.clientX); // 100</code></pre>
        </div>
      </div>
      
      </div><p>Please note: the generic <code>Event</code> constructor does not allow that.</p>
<p>Let’s try:</p>
<div data-trusted="1" class="code-example" data-highlight-block="7-7">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="run" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">let event = new Event(&quot;click&quot;, {
  bubbles: true, // only bubbles and cancelable
  cancelable: true, // work in the Event constructor
  clientX: 100,
  clientY: 100
});

alert(event.clientX); // undefined, the unknown property is ignored!</code></pre>
        </div>
      </div>
      
      </div><p>Technically, we can work around that by assigning directly <code>event.clientX=100</code> after creation. So that’s a matter of convenience and following the rules. Browser-generated events always have the right type.</p>
<p>The full list of properties for different UI events is in the specification, for instance  <a href="https://www.w3.org/TR/uievents/#mouseevent">MouseEvent</a>.</p>
<h2><a class="main__anchor" name="custom-events" href="#custom-events">Custom events</a></h2><p>For our own, custom events like <code>&quot;hello&quot;</code> we should use <code>new CustomEvent</code>. Technically <a href="https://dom.spec.whatwg.org/#customevent">CustomEvent</a> is the same as <code>Event</code>, with one exception.</p>
<p>In the second argument (object) we can add an additional property <code>detail</code> for any custom information that we want to pass with the event.</p>
<p>For instance:</p>
<div data-trusted="1" class="code-example" data-refresh="1" data-highlight-block="9-9" data-highlight-inline="5:10-27">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;h1 id=&quot;elem&quot;&gt;Hello for John!&lt;/h1&gt;

&lt;script&gt;
  // additional details come with the event to the handler
  elem.addEventListener(&quot;hello&quot;, function(event) {
    alert(event.detail.name);
  });

  elem.dispatchEvent(new CustomEvent(&quot;hello&quot;, {
    detail: { name: &quot;John&quot; }
  });
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><p>The <code>detail</code> property can have any data. Technically we could live without, because we can assign any properties into a regular <code>new Event</code> object after its creation. But <code>CustomEvent</code> provides the special <code>detail</code> field for it to evade conflicts with other event properties.</p>
<p>The event class tells something about “what kind of event” it is, and if the event is custom, then we should use <code>CustomEvent</code> just to be clear about what it is.</p>
<h2><a class="main__anchor" name="event-preventdefault" href="#event-preventdefault">event.preventDefault()</a></h2><p>We can call <code>event.preventDefault()</code> on a script-generated event if <code>cancelable:true</code> flag is specified.</p>
<p>Of course, if the event has a non-standard name, then it’s not known to the browser, and there’s no “default browser action” for it.</p>
<p>But the event-generating code may plan some actions after <code>dispatchEvent</code>.</p>
<p>The call of <code>event.preventDefault()</code> is a way for the handler to send a signal that those actions shouldn’t be performed.</p>
<p>In that case the call to <code>elem.dispatchEvent(event)</code> returns <code>false</code>. And the event-generating code knows that the processing shouldn’t continue.</p>
<p>For instance, in the example below there’s a <code>hide()</code> function. It generates the <code>&quot;hide&quot;</code> event on the element <code>#rabbit</code>, notifying all interested parties that the rabbit is going to hide.</p>
<p>A handler set by <code>rabbit.addEventListener('hide',...)</code> will learn about that and, if it wants, can prevent that action by calling <code>event.preventDefault()</code>. Then the rabbit won’t hide:</p>
<div data-trusted="1" class="code-example" data-refresh="1">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;pre id=&quot;rabbit&quot;&gt;
  |\   /|
   \|_|/
   /. .\
  =\_Y_/=
   {&gt;o&lt;}
&lt;/pre&gt;

&lt;script&gt;
  // hide() will be called automatically in 2 seconds
  function hide() {
    let event = new CustomEvent(&quot;hide&quot;, {
      cancelable: true // without that flag preventDefault doesn't work
    });
    if (!rabbit.dispatchEvent(event)) {
      alert('the action was prevented by a handler');
    } else {
      rabbit.hidden = true;
    }
  }

  rabbit.addEventListener('hide', function(event) {
    if (confirm(&quot;Call preventDefault?&quot;)) {
      event.preventDefault();
    }
  });

  // hide in 2 seconds
  setTimeout(hide, 2000);

&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><h2><a class="main__anchor" name="events-in-events-are-synchronous" href="#events-in-events-are-synchronous">Events-in-events are synchronous</a></h2><p>Usually events are processed asynchronously. That is: if the browser is processing <code>onclick</code> and in the process a new event occurs, then it awaits till <code>onclick</code> processing is finished.</p>
<p>The exception is when one event is initiated from within another one.</p>
<p>Then the control jumps to the nested event handler, and after it goes back.</p>
<p>For instance, here the nested <code>menu-open</code> event is processed synchronously, during the <code>onclick</code>:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;button id=&quot;menu&quot;&gt;Menu (click me)&lt;/button&gt;

&lt;script&gt;
  // 1 -&gt; nested -&gt; 2
  menu.onclick = function() {
    alert(1);

    // alert(&quot;nested&quot;)
    menu.dispatchEvent(new CustomEvent(&quot;menu-open&quot;, {
      bubbles: true
    }));

    alert(2);
  };

  document.addEventListener('menu-open', () =&gt; alert('nested'))
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Please note that the nested event <code>menu-open</code> bubbles up and is handled on the <code>document</code>. The propagation of the nested event is fully finished before the processing gets back to the outer code (<code>onclick</code>).</p>
<p>That’s not only about <code>dispatchEvent</code>, there are other cases. JavaScript in an event handler can call methods that lead to other events – they are too processed synchronously.</p>
<p>If we don’t like it, we can either put the <code>dispatchEvent</code> (or other event-triggering call) at the end of <code>onclick</code> or, if inconvenient, wrap it in <code>setTimeout(...,0)</code>:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;button id=&quot;menu&quot;&gt;Menu (click me)&lt;/button&gt;

&lt;script&gt;
  // 1 -&gt; 2 -&gt; nested
  menu.onclick = function() {
    alert(1);

    // alert(2)
    setTimeout(() =&gt; menu.dispatchEvent(new CustomEvent(&quot;menu-open&quot;, {
      bubbles: true
    })), 0);

    alert(2);
  };

  document.addEventListener('menu-open', () =&gt; alert('nested'))
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><h2><a class="main__anchor" name="summary" href="#summary">Summary</a></h2><p>To generate an event, we first need to create an event object.</p>
<p>The generic <code>Event(name, options)</code> constructor accepts an arbitrary event name and the <code>options</code> object with two properties:</p>
<ul>
<li><code>bubbles: true</code> if the event should bubble.</li>
<li><code>cancelable: true</code> is the <code>event.preventDefault()</code> should work.</li>
</ul>
<p>Other constructors of native events like <code>MouseEvent</code>, <code>KeyboardEvent</code> and so on accept properties specific to that event type. For instance, <code>clientX</code> for mouse events.</p>
<p>For custom events we should use <code>CustomEvent</code> constructor. It has an additional option named <code>detail</code>, we should assign the event-specific data to it. Then all handlers can access it as <code>event.detail</code>.</p>
<p>Despite the technical possibility to generate browser events like <code>click</code> or <code>keydown</code>, we should use with the great care.</p>
<p>We shouldn’t generate browser events as it’s a hacky way to run handlers. That’s a bad architecture most of the time.</p>
<p>Native events might be generated:</p>
<ul>
<li>As a dirty hack to make 3rd-party libraries work the needed way, if they don’t provide other means of interaction.</li>
<li>For automated testing, to “click the button” in the script and see if the interface reacts correctly.</li>
</ul>
<p>Custom events with our own names are often generated for architectural purposes, to signal what happens inside our menus, sliders, carousels etc.</p>
</div></article><!--if lang == 'en'--><!--  include /blocks/banner-bottom.en--></div><div class="page__nav-wrap"><a href="default-browser-action.html" data-tooltip="Browser default actions" class="page__nav page__nav_prev"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Previous lesson</span></a><a href="event-details.html" data-tooltip="Events in details" class="page__nav page__nav_next"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Next lesson</span></a></div><div class="article-tablet-foot tablet-only"><div class="article-tablet-foot__layout"><div class="share-icons"><span class="share-icons__title">Share</span><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_tw"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_fb"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_gp"></a><a href="https://vkontakte.ru/share.php?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_vk"></a></div><div class="article-tablet-foot__map"><a href="tutorial/map.html" data-action="tutorial-map" class="map"><span class="map__text">Tutorial map</span></a></div></div></div><div id="comments" class="comments"><div class="comments__header"><h2 class="comments__header-title"><a href="#comments" name="comments">Comments</a></h2><div class="comments__read-before"><span class="comments__read-before-link">read this before commenting…</span><div class="comments__read-before-popup"><div class="comments__read-before-popup-i"><ul><li>You're welcome to post additions, questions to the articles and answers to them.</li><li>To insert a few words of code, use the <code>&lt;code&gt;</code> tag, for several lines – use <code>&lt;pre&gt;</code>, for more than 10 lines – use a sandbox (<a href='http://plnkr.co/edit/?p=preview'>plnkr</a>, <a href='http://jsbin.com/'>JSBin</a>, <a href='http://codepen.io/'>codepen</a>…)</li><li>If you can't understand something in the article – please elaborate.</li></ul></div></div></div></div></div><div id="disqus_thread"></div><script>var disqus_config = function() { if (!this.page) this.page = {}; Object.assign(this.page, {"url":"https:\/\/javascript.info\/dispatch-events","identifier":"\/dispatch-events","title":"Dispatching custom events"}); };</script><script>var disqus_shortname = "javascriptinfo";</script><script>var disqus_enabled = true;</script></main></div><div class="page__sidebar sidebar sidebar_sticky-footer"><button data-sidebar-toggle class="sidebar__toggle"></button><a href="tutorial/map.html" data-action="tutorial-map" data-tooltip="Tutorial map" class="map"></a><div class="sidebar__inner"><div class="sidebar__content"><div class="sidebar__section"><h4 class="sidebar__section-title">Chapter</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="events.html" class="sidebar__link">Introduction into Events</a></li></ul></nav></div><div class="sidebar__section"><h4 class="sidebar__section-title">Lesson navigation</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="#event-constructor" class="sidebar__link">Event constructor</a></li><li class="sidebar__navigation-link"><a href="#dispatchevent" class="sidebar__link">dispatchEvent</a></li><li class="sidebar__navigation-link"><a href="#bubbling-example" class="sidebar__link">Bubbling example</a></li><li class="sidebar__navigation-link"><a href="#mouseevent-keyboardevent-and-others" class="sidebar__link">MouseEvent, KeyboardEvent and others</a></li><li class="sidebar__navigation-link"><a href="#custom-events" class="sidebar__link">Custom events</a></li><li class="sidebar__navigation-link"><a href="#event-preventdefault" class="sidebar__link">event.preventDefault()</a></li><li class="sidebar__navigation-link"><a href="#events-in-events-are-synchronous" class="sidebar__link">Events-in-events are synchronous</a></li><li class="sidebar__navigation-link"><a href="#summary" class="sidebar__link">Summary</a></li></ul></nav></div><div class="sidebar__section"><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="#comments" class="sidebar__link">Comments</a></li></ul></nav></div><div class="sidebar__section"><div class="sidebar__section-title">Share</div><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_tw sidebar__share"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_fb sidebar__share"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fdispatch-events" class="share share_gp sidebar__share"></a></div><div class="sidebar__section"><a href="https://github.com/iliakan/javascript-tutorial-en/tree/master/2-ui/2-events/05-dispatch-events/article.md" class="sidebar__link">Edit on Github</a></div></div></div></div></div></div><div class="page-footer"><div class="page-footer__left"><ul class="page-footer__list"><li class="page-footer__item">©&nbsp;2007—2018&nbsp; Ilya Kantor</li><li class="page-footer__item"><a href="about.html#contact-us" class="page-footer__link">contact us</a></li><li class="page-footer__item"><a href="about.html" class="page-footer__link">about the project</a></li><li class="page-footer__item"><a href="https://learn.javascript.ru/" class="page-footer__link">RU</a> / EN</li></ul></div><div class="page-footer__right"><ul class="page-footer__list"><li class="page-footer__item">powered by <a rel="nofollow" href="http://nodejs.org/" class="page-footer__link">node.js</a>&nbsp;&amp;&nbsp;<a rel="nofollow" href="http://github.com/iliakan/javascript-tutorial-en" class="page-footer__link">open source</a></li></ul></div></div></body>
<!-- Mirrored from javascript.info/dispatch-events by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Sep 2018 10:50:51 GMT -->
</html>