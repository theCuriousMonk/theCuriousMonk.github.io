<!DOCTYPE html><html lang="en">
<!-- Mirrored from javascript.info/onload-ondomcontentloaded by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Sep 2018 10:51:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><script>window.currentUser = null;</script><title itemprop="name">Page lifecycle: DOMContentLoaded, load, beforeunload, unload</title><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700%7COpen+Sans+Condensed:700&amp;subset=latin,latin-ext,cyrillic,cyrillic-ext" rel="stylesheet"><link rel="apple-touch-icon-precomposed" href="img/favicon/apple-touch-icon-precomposed.png"><link rel="canonical" href="onload-ondomcontentloaded.html"><meta name="msapplication-TileColor" content="#222A2C"><meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"><!-- favicon the rest--><link rel="icon" href="img/favicon/favicon.png"><meta itemprop="image" content="https://javascript.info/img/site_preview_en_512x512.png"><meta property="og:title" content="Page lifecycle: DOMContentLoaded, load, beforeunload, unload"><meta property="og:image" content="https://javascript.info/img/site_preview_en_1200x630.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="fb:admins" content="100001562528165"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Page lifecycle: DOMContentLoaded, load, beforeunload, unload"><meta name="twitter:site" content="@iliakan"><meta name="twitter:creator" content="@iliakan"><meta name="twitter:image" content="https://javascript.info/img/site_preview_en_512x512.png"><link href="pack/styles.b363cbd7204b6ec74a4cbeca7061b31d.css" rel="stylesheet"><link rel="prev" href="onscroll.html"><link rel="next" href="onload-onerror.html"><script>window.GA_ID = "UA-2056213-15";</script><script>window.YANDEX_METRIKA_ID = 32184394;</script><script>window.GoogleAnalyticsObject="ga",window.ga=function(){window.ga.q.push(arguments)},window.ga.q=[],window.ga.l=Date.now(),ga("create",GA_ID,"auto"),window.currentUser?ga("set","&uid",currentUser.id):ga("set","anonymizeIp",!0),window.addEventListener("error",function(e){var n=(e.filename||e.errorUrl)+": "+(e.lineno||e.errorLine),r=e.stack||e.error&&e.error.stack;ga("send","exception",{exDescription:e.message+" "+n+" "+r,exFatal:!0})});</script><script src="../www.google-analytics.com/analytics.js" async></script><script>ga('send', 'pageview');</script><script>window.metrika={reachGoal:function(){}},window.yandex_metrika_callbacks=[function(){try{window.metrika=new Ya.Metrika({id:YANDEX_METRIKA_ID,webvisor:!0,clickmap:!0,params:{user:window.currentUser&&window.currentUser.id}}),metrika.trackLinks({delay:150}),window.addEventListener("error",function(r){window.metrika.reachGoal("JSERROR",{src:(r.filename||r.errorUrl)+": "+(r.lineno||r.errorLine),stack:r.stack||r.error&&r.error.stack,message:r.message})})}catch(r){}}];</script><script src="../mc.yandex.ru/metrika/watch.js" async></script><script>window.RECAPTCHA_ID = "6Lf9NyETAAAAACZlg-a9Us2SxvYbeVC1ROWaWv4O";</script><script src="inite4da.js?5"></script><script src="pack/head.5ac6aee21473ea597203.js" defer></script><meta property="og:title" content="Page lifecycle: DOMContentLoaded, load, beforeunload, unload"><meta property="og:type" content="article"><script src="pack/tutorial.5ac6aee21473ea597203.js" defer></script><script src="pack/footer.5ac6aee21473ea597203.js" defer></script></head><body class="no-icons"><script>window.fontTest();</script><div class="page-wrapper page-wrapper_sidebar_on"><!--[if lt IE 10]><div style="color:red;text-align:center">Sorry, IE&lt;10 is not supported, please use a newer browser.</div><![endif]--><div class="sitetoolbar sitetoolbar_tutorial"><div style="display:none" id="notify-en-tutorial" class="notification notification_info notification_top sitetoolbar__notification"><div class="notification__content">The tutorial was recently rewritten from scratch. There may be typos, please use the "Edit on Github" link (in left sidebar in an article, at the bottom) to propose fixes.
Thank you!</div><button title="Close" class="notification__close"></button></div><script>showTopNotification();</script><div class="sitetoolbar__content"><div class="sitetoolbar__logo-wrap"><a href="index.html" class="sitetoolbar__link sitetoolbar__link_logo"><img src="img/sitetoolbar__logo_en.svg" width="200" class="sitetoolbar__logo sitetoolbar__logo_normal" alt=""><img src="img/sitetoolbar__logo_small_en.svg" width="70" class="sitetoolbar__logo sitetoolbar__logo_small" alt=""><script>Array.prototype.forEach.call(document.querySelectorAll("img.sitetoolbar__logo"),function(e){var t=document.createElement("object");t.type="image/svg+xml",t.className=e.className,t.style.cssText="left:0;top:0;position:absolute",t.onload=function(){t.onload=null,e.style.visibility="hidden"},t.data=e.src,e.parentNode.insertBefore(t,e)});</script></a></div><div class="sitetoolbar__nav-toggle-wrap"><button type="button" class="sitetoolbar__nav-toggle"></button></div><nav class="sitetoolbar__sections"><ul class="sitetoolbar__sections-list"><li class="sitetoolbar__section sitetoolbar__section_current"><a href="index.html" class="sitetoolbar__link">Tutorial</a></li><li class="sitetoolbar__section"><a href="courses.html" class="sitetoolbar__link">Courses</a></li></ul></nav><div class="sitetoolbar__book-wrap"><a href="ebook.html" class="buy-book-button"><span class="buy-book-button__extra-text">Buy</span>EPUB/PDF</a></div><div class="sitetoolbar__login-wrap"><button data-action-login class="sitetoolbar__login sitetoolbar__login_unready"></button></div><div class="sitetoolbar__search-wrap"><div class="sitetoolbar__search-content"><form method="GET" action="http://javascript.info/search" class="sitetoolbar__search"><button type="button" class="sitetoolbar__search-toggle"></button><div class="sitetoolbar__search-input"><div class="text-input"><input autofocus name="query" placeholder="Search on Javascript.info" class="text-input__control" type="text"></div><button type="submit" class="sitetoolbar__find">Search</button></div></form></div></div></div><!-- todo: en variant--><div class="tablet-menu"><div class="tablet-menu__line"><div class="tablet-menu__content"><select onchange="if(this.value) window.location.href=this.value" class="input-select input-select_small tablet-menu__nav"><option value="/tutorial" selected>Tutorial</option><option value="/courses">Courses</option></select></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><form action="http://javascript.info/search/" class="tablet-menu-search"><input type="search" name="query" placeholder="Search in the tutorial" required class="tablet-menu-search__input"><button type="submit" name="type" value="articles" class="tablet-menu-search__button">Search</button></form></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><a href="tutorial/map.html" data-action="tutorial-map" class="map"><span class="map__text">Tutorial map</span></a></div></div><!--+e.line--><!--  +e.content--><!--    +b("a").tablet-ebook(href="/ebook")--><!--      +e("span").text Купить учебник--><!--      +e("span").note (EPUB + PDF)--><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="share-icons"><span class="share-icons__title">Share</span><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_tw"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_fb"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_gp"></a><a href="https://vkontakte.ru/share.php?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_vk"></a></div></div></div></div><progress data-sticky value="22" max="27" data-tooltip="Lesson 22 of 27" class="tutorial-progress"></progress></div><div class="page page_sidebar_on"><script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");var pageWrapper=document.querySelector(".page-wrapper");pageWrapper&&pageWrapper.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")},0);</script><div class="page__inner"><main class="main main_width-limit"><header class="main__header"><div class="main__header-inner"><ol class="breadcrumbs"><li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb-1" class="breadcrumbs__item breadcrumbs__item_home"><a href="index.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title" class="breadcrumbs__hidden-text">Tutorial</span></a></li><li id="breadcrumb-1" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemref="breadcrumb-2" itemprop="child" class="breadcrumbs__item"><a href="ui.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title">Browser: Document, Events, Interfaces</span></a></li><li id="breadcrumb-2" itemscope itemtype="http://data-vocabulary.org/Breadcrumb" itemprop="child" class="breadcrumbs__item"><a href="event-details.html" itemprop="url" class="breadcrumbs__link"><span itemprop="title">Events in details</span></a></li></ol><h1 class="main__header-title">Page lifecycle: DOMContentLoaded, load, beforeunload, unload</h1></div></header><div class="content"><article itemscope itemtype="http://schema.org/TechArticle"><meta itemprop="name" content="Page lifecycle: DOMContentLoaded, load, beforeunload, unload"><div itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="email" content="iliakan@gmail.com"><meta itemprop="name" content="Ilya Kantor"></div><div itemprop="articleBody"><p>The lifecycle of an HTML page has three important events:</p>
<ul>
<li><code>DOMContentLoaded</code> – the browser fully loaded HTML, and the DOM tree is built, but external resources like pictures <code>&lt;img&gt;</code> and stylesheets may be not yet loaded.</li>
<li><code>load</code> – the browser loaded all resources (images, styles etc).</li>
<li><code>beforeunload/unload</code> – when the user is leaving the page.</li>
</ul>
<p>Each event may be useful:</p>
<ul>
<li><code>DOMContentLoaded</code> event – DOM is ready, so the handler can lookup DOM nodes, initialize the interface.</li>
<li><code>load</code> event – additional resources are loaded, we can get image sizes (if not specified in HTML/CSS) etc.</li>
<li><code>beforeunload/unload</code> event – the user is leaving: we can check if the user saved the changes and  ask him whether he really wants to leave.</li>
</ul>
<p>Let’s explore the details of these events.</p>
<h2><a class="main__anchor" name="domcontentloaded" href="#domcontentloaded">DOMContentLoaded</a></h2><p>The <code>DOMContentLoaded</code> event happens on the <code>document</code> object.</p>
<p>We must use <code>addEventListener</code> to catch it:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">document.addEventListener(&quot;DOMContentLoaded&quot;, ready);</code></pre>
        </div>
      </div>
      
      </div><p>For instance:</p>
<div data-trusted="1" class="code-example" data-demo-height="200" data-refresh="1" data-highlight-block="8-8">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;script&gt;
  function ready() {
    alert('DOM is ready');

    // image is not yet loaded (unless was cached), so the size is 0x0
    alert(`Image size: ${img.offsetWidth}x${img.offsetHeight}`);
  }

  document.addEventListener(&quot;DOMContentLoaded&quot;, ready);
&lt;/script&gt;

&lt;img id=&quot;img&quot; src=&quot;https://en.js.cx/clipart/train.gif?speed=1&amp;cache=0&quot;&gt;</code></pre>
        </div>
      </div>
      
      </div><p>In the example the <code>DOMContentLoaded</code> handler runs when the document is loaded, not waits for the page load. So <code>alert</code> shows zero sizes.</p>
<p>At the first sight <code>DOMContentLoaded</code> event is very simple. The DOM tree is ready – here’s the event. But there are few peculiarities.</p>
<h3><a class="main__anchor" name="domcontentloaded-and-scripts" href="#domcontentloaded-and-scripts">DOMContentLoaded and scripts</a></h3><p>When the browser initially loads HTML and comes across a <code>&lt;script&gt;...&lt;/script&gt;</code> in the text, it can’t continue building DOM. It must execute the script right now. So <code>DOMContentLoaded</code> may only happen after all such scripts are executed.</p>
<p>External scripts (with <code>src</code>) also put DOM building to pause while the script is loading and executing. So <code>DOMContentLoaded</code> waits for external scripts as well.</p>
<p>The only exception are external scripts with <code>async</code> and <code>defer</code> attributes. They tell the browser to continue processing without waiting for the scripts. So the user can see the page before scripts finish loading, good for performance.</p>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">A word about <code>async</code> and <code>defer</code></span></div>
            <div class="important__content"><p>Attributes <code>async</code> and <code>defer</code> work only for external scripts. They are ignored if there’s no <code>src</code>.</p>
<p>Both of them tell the browser that it may go on working with the page, and load the script “in background”, then run the script when it loads. So the script doesn’t block DOM building and page rendering.</p>
<p>There are two differences between them.</p>
<table>
<thead>
<tr>
<th></th>
<th><code>async</code></th>
<th><code>defer</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Order</td>
<td>Scripts with <code>async</code> execute <em>in the load-first order</em>. Their document order doesn’t matter – which loads first runs first.</td>
<td>Scripts with <code>defer</code> always execute <em>in the document order</em> (as they go in the document).</td>
</tr>
<tr>
<td><code>DOMContentLoaded</code></td>
<td>Scripts with <code>async</code> may load and execute while the document has not yet been fully downloaded. That happens if scripts are small or cached, and the document is long enough.</td>
<td>Scripts with <code>defer</code> execute after the document is loaded and parsed (they wait if needed), right before <code>DOMContentLoaded</code>.</td>
</tr>
</tbody>
</table>
<p>So <code>async</code> is used for totally independent scripts.</p>
</div></div>
<h3><a class="main__anchor" name="domcontentloaded-and-styles" href="#domcontentloaded-and-styles">DOMContentLoaded and styles</a></h3><p>External style sheets don’t affect DOM, and so <code>DOMContentLoaded</code> does not wait for them.</p>
<p>But there’s a pitfall: if we have a script after the style, then that script must wait for the stylesheet to execute:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;
&lt;script&gt;
  // the script doesn't not execute until the stylesheet is loaded
  alert(getComputedStyle(document.body).marginTop);
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><p>The reason is that the script may want to get coordinates and other style-dependent properties of elements, like in the example above. Naturally, it has to wait for styles to load.</p>
<p>As <code>DOMContentLoaded</code> waits for scripts, it now waits for styles before them as well.</p>
<h3><a class="main__anchor" name="built-in-browser-autofill" href="#built-in-browser-autofill">Built-in browser autofill</a></h3><p>Firefox, Chrome and Opera autofill forms on <code>DOMContentLoaded</code>.</p>
<p>For instance, if the page has a form with login and password, and the browser remembered the values, then on <code>DOMContentLoaded</code> it may try to autofill them (if approved by the user).</p>
<p>So if <code>DOMContentLoaded</code> is postponed by long-loading scripts, then autofill also awaits. You probably saw that on some sites (if you use browser autofill) – the login/password fields don’t get autofilled immediately, but there’s a delay till the page fully loads. That’s actually the delay until the <code>DOMContentLoaded</code> event.</p>
<p>One of minor benefits in using <code>async</code> and <code>defer</code> for external scripts – they don’t block <code>DOMContentLoaded</code> and don’t delay browser autofill.</p>
<h2><a class="main__anchor" name="window-onload" href="#window-onload">window.onload</a></h2><p>The <code>load</code> event on the <code>window</code> object triggers when the whole page is loaded including styles, images and other resources.</p>
<p>The example below correctly shows image sizes, because <code>window.onload</code> waits for all images:</p>
<div data-trusted="1" class="code-example" data-demo-height="200" data-refresh="1">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="show" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;script&gt;
  window.onload = function() {
    alert('Page loaded');

    // image is loaded at this time
    alert(`Image size: ${img.offsetWidth}x${img.offsetHeight}`);
  };
&lt;/script&gt;

&lt;img id=&quot;img&quot; src=&quot;https://en.js.cx/clipart/train.gif?speed=1&amp;cache=0&quot;&gt;</code></pre>
        </div>
      </div>
      
      </div><h2><a class="main__anchor" name="window-onunload" href="#window-onunload">window.onunload</a></h2><p>When a visitor leaves the page, the <code>unload</code> event triggers on <code>window</code>. We can do something there that doesn’t involve a delay, like closing related popup windows. But we can’t cancel the transition to another page.</p>
<p>For that we should use another event – <code>onbeforeunload</code>.</p>
<h2><a class="main__anchor" name="window.onbeforeunload" href="#window.onbeforeunload">window.onbeforeunload</a></h2><p>If a visitor initiated navigation away from the page or tries to close the window, the <code>beforeunload</code> handler asks for additional confirmation.</p>
<p>It may return a string with the question. Historically browsers used to show it, but as of now only some of them do. That’s because certain webmasters abused this event handler by showing misleading and hackish messages.</p>
<p>You can try it by running this code and then reloading the page.</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="run" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">window.onbeforeunload = function() {
  return &quot;There are unsaved changes. Leave now?&quot;;
};</code></pre>
        </div>
      </div>
      
      </div><p>Or you can click on the button in <code>&lt;iframe&gt;</code> below to set the handler, and then click the link:</p>
<div class="code-result">
    <div class="code-result__toolbar toolbar"><div class="toolbar__tool">
        <a href="https://en.js.cx/article/onload-ondomcontentloaded/window-onbeforeunload/" target="_blank" title="open in new window" class="toolbar__button toolbar__button_external"></a>
      </div>
      <div class="toolbar__tool">
        <a href="http://plnkr.co/edit/NxRHcQgRqgcO5UeLT3dB?p=preview" target="_blank" title="open in sandbox"
        data-plunk-id="NxRHcQgRqgcO5UeLT3dB" class="toolbar__button toolbar__button_edit"></a>
      </div>
      </div>
    <iframe class="code-result__iframe" data-trusted="1" style="height:80px" src="https://en.js.cx/article/onload-ondomcontentloaded/window-onbeforeunload/"></iframe>
  </div><h2><a class="main__anchor" name="readystate" href="#readystate">readyState</a></h2><p>What happens if we set the <code>DOMContentLoaded</code> handler after the document is loaded?</p>
<p>Naturally, it never runs.</p>
<p>There are cases when we are not sure whether the document is ready or not, for instance an external script with <code>async</code> attribute loads and runs asynchronously. Depending on the network, it may load and execute before the document is complete or after that, we can’t be sure. So we should be able to know the current state of the document.</p>
<p>The <code>document.readyState</code> property gives us information about it. There are 3 possible values:</p>
<ul>
<li><code>&quot;loading&quot;</code> – the document is loading.</li>
<li><code>&quot;interactive&quot;</code> – the document was fully read.</li>
<li><code>&quot;complete&quot;</code> – the document was fully read and all resources (like images) are loaded too.</li>
</ul>
<p>So we can check <code>document.readyState</code> and setup a handler or execute the code immediately if it’s ready.</p>
<p>Like this:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">function work() { /*...*/ }

if (document.readyState == 'loading') {
  document.addEventListener('DOMContentLoaded', work);
} else {
  work();
}</code></pre>
        </div>
      </div>
      
      </div><p>There’s a <code>readystatechange</code> event that triggers when the state changes, so we can print all these states like this:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="run" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="open in sandbox" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code class="language-javascript">// current state
console.log(document.readyState);

// print state changes
document.addEventListener('readystatechange', () =&gt; console.log(document.readyState));</code></pre>
        </div>
      </div>
      
      </div><p>The <code>readystatechange</code> event is an alternative mechanics of tracking the document loading state, it appeared long ago. Nowadays, it is rarely used, but let’s cover it for completeness.</p>
<p>What is the place of <code>readystatechange</code> among other events?</p>
<p>To see the timing, here’s a document with <code>&lt;iframe&gt;</code>, <code>&lt;img&gt;</code> and handlers that log events:</p>
<div data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code class="language-markup">&lt;script&gt;
  function log(text) { /* output the time and message */ }
  log('initial readyState:' + document.readyState);

  document.addEventListener('readystatechange', () =&gt; log('readyState:' + document.readyState));
  document.addEventListener('DOMContentLoaded', () =&gt; log('DOMContentLoaded'));

  window.onload = () =&gt; log('window onload');
&lt;/script&gt;

&lt;iframe src=&quot;iframe.html&quot; onload=&quot;log('iframe onload')&quot;&gt;&lt;/iframe&gt;

&lt;img src=&quot;http://en.js.cx/clipart/train.gif&quot; id=&quot;img&quot;&gt;
&lt;script&gt;
  img.onload = () =&gt; log('img onload');
&lt;/script&gt;</code></pre>
        </div>
      </div>
      
      </div><p>The working example is <a href="http://plnkr.co/edit/kzQEjWfAoTC5XeKAcCNK?p=preview">in the sandbox</a>.</p>
<p>The typical output:</p>
<ol>
<li>[1] initial readyState:loading</li>
<li>[2] readyState:interactive</li>
<li>[2] DOMContentLoaded</li>
<li>[3] iframe onload</li>
<li>[4] readyState:complete</li>
<li>[4] img onload</li>
<li>[4] window onload</li>
</ol>
<p>The numbers in square brackets denote the approximate time of when it happens. The real time is a bit greater, but events labeled with the same digit happen approximately at the same time (± a few ms).</p>
<ul>
<li><code>document.readyState</code> becomes <code>interactive</code> right before <code>DOMContentLoaded</code>. These two events actually mean the same.</li>
<li><code>document.readyState</code> becomes <code>complete</code> when all resources (<code>iframe</code> and <code>img</code>) are loaded. Here we can see that it happens in about the same time as <code>img.onload</code> (<code>img</code> is the last resource) and <code>window.onload</code>. Switching to <code>complete</code> state means the same as <code>window.onload</code>. The difference is that <code>window.onload</code> always works after all other <code>load</code> handlers.</li>
</ul>
<h2><a class="main__anchor" name="summary" href="#summary">Summary</a></h2><p>Page lifecycle events:</p>
<ul>
<li><code>DOMContentLoaded</code> event triggers on <code>document</code> when DOM is ready. We can apply JavaScript to elements at this stage.
<ul>
<li>All scripts are executed except those that are external with <code>async</code> or <code>defer</code></li>
<li>Images and other resources may still continue loading.</li>
</ul>
</li>
<li><code>load</code> event on <code>window</code> triggers when the page and all resources are loaded. We rarely use it, because there’s usually no need to wait for so long.</li>
<li><code>beforeunload</code> event on <code>window</code> triggers when the user wants to leave the page. If it returns a string, the browser shows a question whether the user really wants to leave or not.</li>
<li><code>unload</code> event on <code>window</code> triggers when the user is finally leaving, in the handler we can only do simple things that do not involve delays or asking a user. Because of that limitation, it’s rarely used.</li>
<li><code>document.readyState</code> is the current state of the document, changes can be tracked in the <code>readystatechange</code> event:
<ul>
<li><code>loading</code> – the document is loading.</li>
<li><code>interactive</code> – the document is parsed, happens at about the same time as <code>DOMContentLoaded</code>, but before it.</li>
<li><code>complete</code> – the document and resources are loaded, happens at about the same time as <code>window.onload</code>, but before it.</li>
</ul>
</li>
</ul>
</div></article><!--if lang == 'en'--><!--  include /blocks/banner-bottom.en--></div><div class="page__nav-wrap"><a href="onscroll.html" data-tooltip="Scrolling" class="page__nav page__nav_prev"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Previous lesson</span></a><a href="onload-onerror.html" data-tooltip="Resource loading: onload and onerror" class="page__nav page__nav_next"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Next lesson</span></a></div><div class="article-tablet-foot tablet-only"><div class="article-tablet-foot__layout"><div class="share-icons"><span class="share-icons__title">Share</span><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_tw"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_fb"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_gp"></a><a href="https://vkontakte.ru/share.php?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_vk"></a></div><div class="article-tablet-foot__map"><a href="tutorial/map.html" data-action="tutorial-map" class="map"><span class="map__text">Tutorial map</span></a></div></div></div><div id="comments" class="comments"><div class="comments__header"><h2 class="comments__header-title"><a href="#comments" name="comments">Comments</a></h2><div class="comments__read-before"><span class="comments__read-before-link">read this before commenting…</span><div class="comments__read-before-popup"><div class="comments__read-before-popup-i"><ul><li>You're welcome to post additions, questions to the articles and answers to them.</li><li>To insert a few words of code, use the <code>&lt;code&gt;</code> tag, for several lines – use <code>&lt;pre&gt;</code>, for more than 10 lines – use a sandbox (<a href='http://plnkr.co/edit/?p=preview'>plnkr</a>, <a href='http://jsbin.com/'>JSBin</a>, <a href='http://codepen.io/'>codepen</a>…)</li><li>If you can't understand something in the article – please elaborate.</li></ul></div></div></div></div></div><div id="disqus_thread"></div><script>var disqus_config = function() { if (!this.page) this.page = {}; Object.assign(this.page, {"url":"https:\/\/javascript.info\/onload-ondomcontentloaded","identifier":"\/onload-ondomcontentloaded","title":"Page lifecycle: DOMContentLoaded, load, beforeunload, unload"}); };</script><script>var disqus_shortname = "javascriptinfo";</script><script>var disqus_enabled = true;</script></main></div><div class="page__sidebar sidebar sidebar_sticky-footer"><button data-sidebar-toggle class="sidebar__toggle"></button><a href="tutorial/map.html" data-action="tutorial-map" data-tooltip="Tutorial map" class="map"></a><div class="sidebar__inner"><div class="sidebar__content"><div class="sidebar__section"><h4 class="sidebar__section-title">Chapter</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="event-details.html" class="sidebar__link">Events in details</a></li></ul></nav></div><div class="sidebar__section"><h4 class="sidebar__section-title">Lesson navigation</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="#domcontentloaded" class="sidebar__link">DOMContentLoaded</a></li><li class="sidebar__navigation-link"><a href="#window-onload" class="sidebar__link">window.onload</a></li><li class="sidebar__navigation-link"><a href="#window-onunload" class="sidebar__link">window.onunload</a></li><li class="sidebar__navigation-link"><a href="#window.onbeforeunload" class="sidebar__link">window.onbeforeunload</a></li><li class="sidebar__navigation-link"><a href="#readystate" class="sidebar__link">readyState</a></li><li class="sidebar__navigation-link"><a href="#summary" class="sidebar__link">Summary</a></li></ul></nav></div><div class="sidebar__section"><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a href="#comments" class="sidebar__link">Comments</a></li></ul></nav></div><div class="sidebar__section"><div class="sidebar__section-title">Share</div><a href="https://twitter.com/share?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_tw sidebar__share"></a><a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_fb sidebar__share"></a><a href="https://plus.google.com/share?url=https%3A%2F%2Fjavascript.info%2Fonload-ondomcontentloaded" class="share share_gp sidebar__share"></a></div><div class="sidebar__section"><a href="https://github.com/iliakan/javascript-tutorial-en/tree/master/2-ui/3-event-details/10-onload-ondomcontentloaded/article.md" class="sidebar__link">Edit on Github</a></div></div></div></div></div></div><div class="page-footer"><div class="page-footer__left"><ul class="page-footer__list"><li class="page-footer__item">©&nbsp;2007—2018&nbsp; Ilya Kantor</li><li class="page-footer__item"><a href="about.html#contact-us" class="page-footer__link">contact us</a></li><li class="page-footer__item"><a href="about.html" class="page-footer__link">about the project</a></li><li class="page-footer__item"><a href="https://learn.javascript.ru/" class="page-footer__link">RU</a> / EN</li></ul></div><div class="page-footer__right"><ul class="page-footer__list"><li class="page-footer__item">powered by <a rel="nofollow" href="http://nodejs.org/" class="page-footer__link">node.js</a>&nbsp;&amp;&nbsp;<a rel="nofollow" href="http://github.com/iliakan/javascript-tutorial-en" class="page-footer__link">open source</a></li></ul></div></div></body>
<!-- Mirrored from javascript.info/onload-ondomcontentloaded by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 10 Sep 2018 10:51:04 GMT -->
</html>